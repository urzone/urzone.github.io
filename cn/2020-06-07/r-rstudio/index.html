<!DOCTYPE html>
<html lang="cmn-Hans-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>用 R 进行绘图、写作与网站 - XiaO | 缄默之语</title>
    <meta property="og:title" content="用 R 进行绘图、写作与网站 - XiaO | 缄默之语">
    
    <meta name="twitter:card" content="summary">

    
      
    

    
      
      <meta property="description" content="brew install r brew install --cask rstudio # 稳定版 brew install --cask rstudio-preview # 预览版 brew install --cask rstudio-daily # 日更版 本机安装的 rstudio &amp;hellip;">
      <meta property="og:description" content="brew install r brew install --cask rstudio # 稳定版 brew install --cask rstudio-preview # 预览版 brew install --cask rstudio-daily # 日更版 本机安装的 rstudio &amp;hellip;">
      
    

    
    
    
    <meta name="twitter:image" content="https://urz.one/images/logo.png">
    
    

    

    
    
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    



<link rel="stylesheet" href="/css/custom.css" />


<link rel="apple-touch-icon" sizes="180x180" href="/images/icons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/images/icons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/images/icons/favicon-16x16.png">
<link rel="manifest" href="/images/icons/manifest.json">
<link rel="mask-icon" href="/images/icons/safari-pinned-tab.svg" color="#cc342c">
<link rel="shortcut icon" href="/images/icons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="XiaO">
<meta name="application-name" content="XiaO">
<meta name="msapplication-TileColor" content="#603cba">
<meta name="msapplication-TileImage" content="/images/icons/mstile-144x144.png">
<meta name="msapplication-config" content="/images/icons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">
<meta name="google-site-verification" content="3C4lz-WqreDsFFohPRed1rO14aKeEDmTbw2lfIHN6og" />
  </head>

  
  <body class="cn">
    <header class="masthead">
      

<h1><a href="/"><img src="/images/logo.svg" alt="XiaO" /></a></h1>



      <nav class="menu">
  <ul>
  
  
  <li><a href="/">首页</a></li>
  
  <li><a href="/cn/">日志</a></li>
  
  <li><a href="/cn/note/">缄语</a></li>
  
  <li><a href="/en/">En</a></li>
  
  

<li class="menu-extra"></li>


<li><a href="/cn/index.xml" type="application/rss+xml" title="RSS feed">订阅</a></li>

<li><a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="Attribution-NonCommercial-ShareAlike 4.0 International">版权</a></li>


  </ul>
</nav>

    </header>

    <article class="main">
      <header class="title">
      
<h1>用 R 进行绘图、写作与网站</h1>


<h3>XiaO / 
2020-06-07</h3>

<hr>


      </header>



<h3 id="安装-rrstudio-与-pandoc">安装 R，RStudio 与 pandoc</h3>
<pre tabindex="0"><code>brew install r

brew install --cask rstudio # 稳定版
brew install --cask rstudio-preview # 预览版
brew install --cask rstudio-daily # 日更版

本机安装的 rstudio 版本为 [2021.09.0,351](https://dailies.rstudio.com/version/2021.09.0+351.pro6/)

brew install pandoc
</code></pre><pre tabindex="0"><code>https://cran.r-project.org/src/base/R-4/ # R 4.0 语言安装包（可查看到不同的版本号以及源码）

  R-4.0.0.tar.gz  2020-04-24 09:05  32M  
[   ] R-4.0.1.tar.gz  2020-06-06 09:05  32M  
[   ] R-4.0.2.tar.gz  2020-06-22 09:05  32M  
[   ] R-4.0.3.tar.gz  2020-10-10 09:05  32M
[   ] R-4.0.4.tar.gz  2021-02-15 09:05  32M  
[   ] R-4.0.5.tar.gz  2021-03-31 09:05  31M 
[   ] R-4.1.0.tar.gz  2021-05-18 09:05  32M  
[   ] R-4.1.1.tar.gz  2021-08-10 09:05  32M  
[   ] R-4.1.2.tar.gz  2021-11-01 09:05  32M  
[   ] R-4.1.3.tar.gz  2022-03-10 09:05  33M  
[   ] R-4.2.0.tar.gz  2022-04-22 09:05  36M  

brew install --build-from-source r
</code></pre><pre tabindex="0"><code>https://hackage.haskell.org/package/pandoc # Pandoc 安装包（可查看到不同的版本号以及源码）

https://github.com/jgm/pandoc/tags
</code></pre><h3 id="设置-sublime-texthttpswwwsublimetextcomdownload-为-terminal-默认编辑器httpsdevto10xlearnerhow-to-set-up-sublime-text-command-line-on-osx-quick-tip-52ld">设置 <a href="https://www.sublimetext.com/download">Sublime Text</a> <a href="https://dev.to/10xlearner/how-to-set-up-sublime-text-command-line-on-osx-quick-tip-52ld">为 Terminal 默认编辑器</a></h3>
<p>在 <code>~/.zshrc</code> 配置文件中添加如下一条语句即可，即将 Sublime Text 的命令行快捷方式添加到 PATH 中。</p>
<pre tabindex="0"><code># Adding Sublime Text as the default efitor for Terminal, 似乎不同版本或安装方式的配置会不同
export EDITOR=&#39;subl -w&#39; # brew --cask 版本可正常打开。

export PATH=$PATH:/Applications/Sublime\ Text.app/Contents/SharedSupport/bin
</code></pre><h4 id="pandoc-的引文格式4">pandoc 的<a href="https://bookdown.org/yihui/bookdown/citations.html">引文格式</a>。</h4>
<p>Pandoc 默认管理引文的方法是使用 <code>pandoc-citeproc</code>。该工具依据 <a href="http://docs.citationstyles.org/en/1.0.1/specification.html">Citation Style Language (CSL)</a> 规范管理文献，其中各个杂志的引文格式，可从 <a href="https://www.zotero.org/styles/">Zotero Style Repository</a> 下载。</p>
<p>Terminal 中启动 R 后提示</p>
<pre tabindex="0"><code>During startup - Warning messages:  
1: Setting LC_COLLATE failed, using &#34;C&#34;   
2: Setting LC_TIME failed, using &#34;C&#34;   
3: Setting LC_MESSAGES failed, using &#34;C&#34;   
4: Setting LC_MONETARY failed, using &#34;C&#34;  
</code></pre><p>关于 <a href="https://wiki.archlinux.org/index.php/Locale_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">Locale</a>和<a href="https://docs.oracle.com/cd/E37934_01/html/E36634/glmbx.html">语言环境</a></p>
<p>add the codes to shell config file</p>
<pre tabindex="0"><code>export LANG=en_GB.UTF-8
export LC_ALL=en_GB.UTF-8
</code></pre><h3 id="自定义-r-包的安装位置-说明之-一1-二2-三3">自定义 R 包的安装位置 说明之 <a href="https://blog.csdn.net/kuyu05/article/details/83303803">一</a> <a href="https://www.accelebrate.com/library/how-to-articles/r-rstudio-library">二</a> <a href="https://stackoverflow.com/questions/15170399/change-r-default-library-path-using-libpaths-in-rprofile-site-fails-to-work">三</a></h3>
<p>查看 R 包的安装位置：</p>
<pre tabindex="0"><code>.libPaths()
</code></pre><p>R 在启动时会自动加载的其配置文件，可通过修改该配置文件来修改包的默认安装位置，比如我们将其安装到 <code>~/Rpackages</code>。</p>
<p>homebrew 安装的 R 的位置为 <code>/usr/local/Cellar/</code>，其配置文件的位置 <code>/usr/local/Cellar/r/4.0.0_1/lib/R/library/base/R/Rprofile</code> （注意版本号的不同）。</p>
<p>更新 R 以后，可以找到该文件，把上述包的位置重新写入即可，不必重新下载安装所有包，省事不少。</p>
<pre tabindex="0"><code># Rprofile.site
.libPaths( c( &#34;~/Rpackages&#34;, .libPaths()))
</code></pre><p>为进一步简化配置，可以添加 <code>~/.Rprofile</code>  文件，该文件为 R 全局配置文件，每次启动将自动加载该文件。</p>
<pre tabindex="0"><code># Rprofile.site
.libPaths(c(&#34;~/Rpackages&#34;, .libPaths()))
</code></pre><p>还可在每个 R 项目中 <code>*.Rproj</code> 所在位置添加单独的项目级 <code>.Rprofile</code> 文件，为每个项目单独添加相应的启动项，譬如：</p>
<pre tabindex="0"><code>if (file.exists(&#34;~/.Rprofile&#34;)) {
  base::sys.source(&#34;~/.Rprofile&#34;, envir = environment())
}

# Load library
library(viridis, quietly=TRUE, warn.conflicts=FALSE)
library(cowplot)
library(stats)
library(tidyverse)
</code></pre><h3 id="安装-r-包">安装 R 包</h3>
<p>启动 RStudio，安装 R 包。</p>
<pre tabindex="0"><code>install.packages(c(&#34;tidyverse&#34;,&#34;svglite&#34;)) # 用 R 画图
install.packages(c(&#34;blogdown&#34;, &#34;rmarkdown&#34;,&#34;bookdown&#34;, &#34;tinytex&#34;,&#34;rticles&#34;,&#34;kableExtra&#34;)) # 生成网站或论文
</code></pre><p><a href="https://github.com/paleolimbot/rbbt">包 rbbt</a> 版本更新比 R 慢，导致其和 R 有匹配问题。如果使用 rbbt，可能需要安装较旧版本的 r。</p>
<h3 id="利用-tinytex-包来安装--latex-发行版-tinytex">利用 tinytex 包来安装  LaTeX 发行版 TinyTeX</h3>
<pre tabindex="0"><code>tinytex::install_tinytex()

tinytex::install_tinytex()
Error in curlGetHeaders(&#34;https://mirror.ctan.org/systems/texlive/tlnet&#34;) : 
  libcurl error code 60:
	SSL certificate problem: certificate has expired
	
tinytex::install_tinytex(repository = &#34;http://mirrors.tuna.tsinghua.edu.cn/CTAN/&#34;, version = &#34;latest&#34;)
trying URL &#39;https://github.com/rstudio/tinytex-releases/releases/download/v2022.05/TinyTeX-1-v2022.05.tgz&#39;
Content type &#39;application/octet-stream&#39; length 88404844 bytes (84.3 MB)
==================================================
downloaded 84.3 MB

tlmgr option repository &#39;http://mirrors.tuna.tsinghua.edu.cn/CTAN/systems/texlive/tlnet&#39;
tlmgr: setting default package repository to http://mirrors.tuna.tsinghua.edu.cn/CTAN/systems/texlive/tlnet
tlmgr: updating ~/Library/TinyTeX/tlpkg/texlive.tlpdb
tlmgr update --list
tlmgr: package repository http://mirrors.tuna.tsinghua.edu.cn/CTAN/systems/texlive/tlnet (not verified: gpg unavailable)
update:   babel              [186k]: local:    63189, source:    63498
update:   fancyvrb            [12k]: local:    63012, source:    63496
update:   fontspec            [27k]: local:    61617, source:    63386
update:   hyperref            [89k]: local:    62142, source:    63323
update:   l3kernel           [169k]: local:    63177, source:    63476
update:   l3packages          [22k]: local:    61588, source:    63505
update:   latex-amsmath-dev   [31k]: local:    62725, source:    63339
update:   latex-tools-dev     [43k]: local:    62725, source:    63339
update:   texlive-scripts    [108k]: local:    63172, source:    63503
</code></pre><h3 id="安装-hugo-v0850-静态博客生成器">安装 hugo v0.85.0 （静态博客生成器）</h3>
<p>新版 hugo v0.89.4 与 blogdown 的 Addins 有冲突，在使用 <code>blogdown:::new_post_addin()</code> 时，无法生成并打开新的文件。</p>
<pre tabindex="0"><code>brew install hugo

Warning: Error in file: cannot open the connection
  9: shiny::runApp
  8: shiny::runGadget
  7: eval
  6: eval
  5: sys.source
  2: source_addin
  1: blogdown:::new_post_addin
</code></pre><pre tabindex="0"><code>brew edit hugo
# 改变版本地址 url
url &#34;https://github.com/gohugoio/hugo/archive/v0.89.4.tar.gz&#34; -&gt; url &#34;https://github.com/gohugoio/hugo/archive/v0.85.0.tar.gz&#34; 
# 去除 fomular 中的 SHA 值验证
sha256 &#34;9d4f61788f8d886913a1be15b3eae04fad04a4e243bd7f65c5e7367bd617856d&#34; -&gt; sha256 :no_check 
# 或者直接将  SHA 值验证注释掉
# sha256 &#34;9d4f61788f8d886913a1be15b3eae04fad04a4e243bd7f65c5e7367bd617856d&#34;

brew install --build-from-source hugo

brew pin hugo # To stop updating a particular package
brew unpin hugo # To Unpin a package
</code></pre>

  <footer>
  
<nav class="post-nav">
  <span class="nav-prev">&larr; <a href="/cn/2020-06-06/shell-zsh-bash-path/">关于人机交互的 shell</a></span>
  <span class="nav-next"><a href="/cn/2020-06-07/pyenv-python/">使用 pyenv 管理 python 版本</a> &rarr;</span>
</nav>
<script type="text/javascript">
document.addEventListener('keyup', function(e) {
  if (e.target.nodeName.toUpperCase() != 'BODY') return;
  var url = false;
  if (e.which == 37) {  
    
    url = '\/cn\/2020-06-06\/shell-zsh-bash-path\/';
    
  } else if (e.which == 39) {  
    
    url = '\/cn\/2020-06-07\/pyenv-python\/';
    
  }
  if (url) window.location = url;
});
</script>






<script async src="/js/fix-toc.js"></script>


<script async src="/js/center-img.js"></script>


<script async src="/js/right-quote.js"></script>


<script async src="/js/fix-footnote.js"></script>


<script async src="/js/math-code.js"></script>


<script async src="/js/external-link.js"></script>


<script async src="/js/alt-title.js"></script>


<script async src="/js/header-link.js"></script>




<script async src="//mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=UA-1988641-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-1988641-2');
</script>

  
  
  <hr>
  <div class="copyright">© <a href="/">XiaO</a> 2006 - 2022</div>
  
  </footer>
  </article>
  
  </body>
</html>

